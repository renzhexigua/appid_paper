2012年

## 摘要

* 目前已有的三大类网络流量分类系统：基于端口、基于数据包负载特征匹配、基于数据包统计行为特征
* 思路：先利用基于负载行为特征的分类方法对数据流进行分类，产生训练集，然后通过训练集训练基于行为特征的分类方法，最后结合起来，形成一个混合分类器，并在一定时段后，重新训练分类方法

## 正文

* L7-filter
	* 计算资源需求量大
	* 成本高，协议指纹难以总结
	* 加密和私有协议的识别能力弱
	* 设计隐私问题，违反相关法律法规
	* 实时性不好，基于负载模式匹配的都有一定甚至很大的时延处理
* 基于统计特征的分类方法：
	* 包大小
	* 包大小的max/min/avg/D(x)/time_period/max(time_period)/min(time_period)/D(time_xx)/totalBytes/totalPackets/avg(Packets)
* 机器学习、统计算法 -> 分类特征集的选择准则和影响因子
* 协同过滤、聚类分析
* 实验中只针对TCP协议进行分析、且只研究单方向的数据流
* 机器学习
	* 有监督：事先给每个样本标上对应类别的标签，根据具有相同类标签的样本找共同特征
	* 无监督：不需要事先标标签，而是根据样本间的某种已定义的关系如距离等将相近的样本划分成一个簇类。
* 特征指标选取原则：来自相同应用层协议的网络流的不同样本流的特征值尽量接近；而来自不同应用协议网络流的样本流的特征值差异尽量大。
* 流量分类的评价指标：
	* 正确率：被分类器分配到某个协议P中的所有样本数中,确实是这个协议的样本数占的比例,用PT表示;
	* 召回率,指的是某个协议的流被分类器正确分类的数目占这个协议的所有网络流总数的比例,用RT表示;
	* 复杂度,包括处理时所消耗的时间以及空间;
	* 实时性
	* 维护成本
* 正则表达式和匹配引擎
* 自动状态机模型：
	* 由五个组成元素:初始状态,有穷输入集,有穷状态集,转移函数和接受状态集。有限自动机分为NFA和DFA,其区别在于:对于确定的状态和确定输入,NFA可以有多个后继状态,而DFA则只能有唯一的后继状态,在任何时候NFA可能同时有几个活动状态存在,而DFA中有且只能仅有一个活动状态。NFA和DFA在描述能力上是等价的。DFA是由基于NFA的状态集合构造的.
	* NFA和DFA的复杂度：
		* NFA 时间复杂度O(n^2)，空间复杂度O(n)
		* DFA 时间复杂度O(1)，空间复杂度O(∑^n)
	DFA是通过将NFA转换生成的,器算法的核心思想:当使用NFA遍历待搜索文本时,会经过很多转移,因此会激活一个状态集合。然而,确定自动机DFA在一个时刻只有一个确定的活动状态,因此可以在NFA的状态集合上定义出相应的DFA。在输入待匹配文本后,每一个输入符号都有一个确定的转移[31]
* 论文中使用的是多报文逐次叠加匹配





